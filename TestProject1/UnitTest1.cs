using Firebase.Database;
using Microsoft.AspNetCore.Authentication;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using Microsoft.Extensions.DependencyInjection;
using System.Security.Claims;
using WebVersion.Models;
using WebVersion.Pages;

namespace TestProject1
{
    [TestClass]
    public class UnitTest1
    {
        private IHttpContextAccessor _httpContextAccessor;
        private IHttpClientFactory _httpClientFactory;

        public UnitTest1() { }

        [TestInitialize]
        public void InitializeAsync()
        {
            // Инициализация зависимостей
            // Создаем заглушечный контекст HTTP
            var context = new DefaultHttpContext();
            // Устанавливаем необходимые свойства для контекста
            // Например, устанавливаем пользователя, метод запроса, путь и т.д.
            context.User = new ClaimsPrincipal(); // Установите пользователя по необходимости
            context.Request.Method = "GET";
            context.Request.Path = "/some/path";
            // Создаем заглушку IHttpContextAccessor
            _httpContextAccessor = new HttpContextAccessor { HttpContext = context };
            
            var services = new ServiceCollection();
            services.AddHttpClient(); // Добавляем HttpClientFactory в коллекцию сервисов
            var serviceProvider = services.BuildServiceProvider();
            _httpClientFactory = serviceProvider.GetService<IHttpClientFactory>();
            Task.Run(userAuth);
        }

        private async Task userAuth()
        {
            var claims = new List<Claim>
            {
                                    new Claim(ClaimTypes.Name, $"Aylin"),
                                    new Claim(ClaimTypes.Surname, $"https://firebasestorage.googleapis.com/v0/b/antrap-firebase.appspot.com/o/OldPif.jpg?alt=media&token=6b117022-e75e-4b3c-b859-937f89516f8b"),
                                    new Claim(ClaimTypes.Email, $"xportbfgh2821@gmail.com"),
                                    new Claim(ClaimTypes.Role, "Разработчик")
                                };

            var identity = new ClaimsIdentity(
                claims, "MyCookieAuthenticationScheme");

            var authProperties = new AuthenticationProperties
            {
                IsPersistent = true,
                ExpiresUtc = DateTimeOffset.UtcNow.AddHours(1)
            };

            var principal = new ClaimsPrincipal(identity);

            await _httpContextAccessor.HttpContext.SignInAsync(
                "MyCookieAuthenticationScheme",
                principal,
                authProperties);
        }

        /// <summary>
        /// Данный тест проверяет получение всех пользователей
        /// из базы данных
        /// </summary>
        [TestMethod]
        public void GetUsersTest()
        {
            UserListModel model = new UserListModel();

            List<User> expectedUsers = new List<User>()
            {
                new User()
                {
                    Id = "XmqIOOn9JhUotWDJSxR4VNNPTp93",
                    Email = "user1@gmail.com",
                    ImageSource = "https://firebasestorage.googleapis.com/v0/b/antrap-firebase.appspot.com/o/OldPif.jpg?alt=media&token=6b117022-e75e-4b3c-b859-937f89516f8b",
                    Login = "user1",
                    Role = "Пользователь"
                },
                new User()
                {
                    Id = "PE2yhrsi8gVhdFCNgCzqutFx16t1",
                    Email = "user2@gmail.com",
                    ImageSource = "null",
                    Login = "user2",
                    Role = "Пользователь"
                },
                new User()
                {
                    Id = "USzjL2WohMXgZ9bdK7W2ZpKCjOR2",
                    Email = "xportbfgh2821@gmail.com",
                    ImageSource = "https://firebasestorage.googleapis.com/v0/b/antrap-firebase.appspot.com/o/OldPif.jpg?alt=media&token=6b117022-e75e-4b3c-b859-937f89516f8b",
                    Login = "Aylin",
                    Role = "Разработчик"
                }
            };

            Task.Run(model.GetUsers);
            while (model.Users == null) { continue; }
            List<User> users = model.Users.ToList();

            if (users.Count == expectedUsers.Count)
            {
                for (int i = 0; i < users.Count; i++)
                {
                    Assert.AreEqual(users[i].ToString(), expectedUsers[i].ToString());
                }
            }
        }
        /// <summary>
        /// Данный тест проверят корректность полученных данных
        /// со стороны
        /// </summary>
        [TestMethod]
        public async Task GetMangasTest_SearchManga()
        {
            MangaModel mangaModel = new MangaModel(_httpClientFactory, _httpContextAccessor);

            string searchManga = "Сталь";

            HttpClient httpClient = new HttpClient();
            httpClient.BaseAddress = new Uri("https://shikimori.me");
            httpClient.DefaultRequestHeaders.Authorization = new System.Net.Http.Headers.AuthenticationHeaderValue("User-Agent", "ShikiOAuthTest");

            string expectedResult = "[{\"id\":4118,\"name\":\"Hagane\",\"russian\":\"Сталь\",\"image\":{\"original\":\"/system/mangas/original/4118.jpg?1675133163\",\"preview\":\"/system/mangas/preview/4118.jpg?1675133163\",\"x96\":\"/system/mangas/x96/4118.jpg?1675133163\",\"x48\":\"/system/mangas/x48/4118.jpg?1675133163\"},\"url\":\"/mangas/4118-hagane\",\"kind\":\"manga\",\"score\":\"6.6\",\"status\":\"released\",\"volumes\":16,\"chapters\":110,\"aired_on\":\"1998-04-01\",\"released_on\":\"2002-12-17\"},{\"id\":25,\"name\":\"Fullmetal Alchemist\",\"russian\":\"Стальной алхимик\",\"image\":{\"original\":\"/system/mangas/original/25.jpg?1682899914\",\"preview\":\"/system/mangas/preview/25.jpg?1682899914\",\"x96\":\"/system/mangas/x96/25.jpg?1682899914\",\"x48\":\"/system/mangas/x48/25.jpg?1682899914\"},\"url\":\"/mangas/z25-fullmetal-alchemist\",\"kind\":\"manga\",\"score\":\"9.04\",\"status\":\"released\",\"volumes\":27,\"chapters\":116,\"aired_on\":\"2001-07-12\",\"released_on\":\"2010-09-11\"},{\"id\":473,\"name\":\"Peace Maker Kurogane\",\"russian\":\"Железный миротворец\",\"image\":{\"original\":\"/system/mangas/original/473.jpg?1682900444\",\"preview\":\"/system/mangas/preview/473.jpg?1682900444\",\"x96\":\"/system/mangas/x96/473.jpg?1682900444\",\"x48\":\"/system/mangas/x48/473.jpg?1682900444\"},\"url\":\"/mangas/473-peace-maker-kurogane\",\"kind\":\"manga\",\"score\":\"7.73\",\"status\":\"ongoing\",\"volumes\":0,\"chapters\":0,\"aired_on\":\"2002-02-28\",\"released_on\":null},{\"id\":789,\"name\":\"Full Metal Panic!\",\"russian\":\"Стальная тревога!\",\"image\":{\"original\":\"/system/mangas/original/789.jpg?1675128338\",\"preview\":\"/system/mangas/preview/789.jpg?1675128338\",\"x96\":\"/system/mangas/x96/789.jpg?1675128338\",\"x48\":\"/system/mangas/x48/789.jpg?1675128338\"},\"url\":\"/mangas/789-full-metal-panic\",\"kind\":\"manga\",\"score\":\"7.79\",\"status\":\"released\",\"volumes\":9,\"chapters\":58,\"aired_on\":\"2000-01-09\",\"released_on\":\"2005-03-09\"},{\"id\":895,\"name\":\"Full Metal Panic! Sigma\",\"russian\":\"Стальная тревога: Сигма\",\"image\":{\"original\":\"/system/mangas/original/895.jpg?1675128540\",\"preview\":\"/system/mangas/preview/895.jpg?1675128540\",\"x96\":\"/system/mangas/x96/895.jpg?1675128540\",\"x48\":\"/system/mangas/x48/895.jpg?1675128540\"},\"url\":\"/mangas/895-full-metal-panic-sigma\",\"kind\":\"manga\",\"score\":\"8.33\",\"status\":\"released\",\"volumes\":19,\"chapters\":90,\"aired_on\":\"2005-04-09\",\"released_on\":\"2013-09-09\"},{\"id\":47296,\"name\":\"Kendo Shitouden Cestvs\",\"russian\":\"Стальной кулак боец Цестус\",\"image\":{\"original\":\"/system/mangas/original/47296.jpg?1682924746\",\"preview\":\"/system/mangas/preview/47296.jpg?1682924746\",\"x96\":\"/system/mangas/x96/47296.jpg?1682924746\",\"x48\":\"/system/mangas/x48/47296.jpg?1682924746\"},\"url\":\"/mangas/47296-kendo-shitouden-cestvs\",\"kind\":\"manga\",\"score\":\"7.33\",\"status\":\"ongoing\",\"volumes\":0,\"chapters\":0,\"aired_on\":\"2010-05-28\",\"released_on\":null},{\"id\":32409,\"name\":\"Full Metal Alchemist: Prototype\",\"russian\":\"Стальной алхимик: Прототип\",\"image\":{\"original\":\"/system/mangas/original/32409.jpg?1675151439\",\"preview\":\"/system/mangas/preview/32409.jpg?1675151439\",\"x96\":\"/system/mangas/x96/32409.jpg?1675151439\",\"x48\":\"/system/mangas/x48/32409.jpg?1675151439\"},\"url\":\"/mangas/32409-full-metal-alchemist-prototype\",\"kind\":\"one_shot\",\"score\":\"7.36\",\"status\":\"released\",\"volumes\":0,\"chapters\":1,\"aired_on\":\"2011-06-10\",\"released_on\":null},{\"id\":37387,\"name\":\"Nejimakiboshi to Aoi Sora\",\"russian\":\"Стальная звезда в лазурном небе\",\"image\":{\"original\":\"/system/mangas/original/37387.jpg?1675152885\",\"preview\":\"/system/mangas/preview/37387.jpg?1675152885\",\"x96\":\"/system/mangas/x96/37387.jpg?1675152885\",\"x48\":\"/system/mangas/x48/37387.jpg?1675152885\"},\"url\":\"/mangas/37387-nejimakiboshi-to-aoi-sora\",\"kind\":\"manga\",\"score\":\"6.48\",\"status\":\"released\",\"volumes\":1,\"chapters\":4,\"aired_on\":\"2007-12-27\",\"released_on\":\"2008-03-27\"},{\"id\":42629,\"name\":\"Koutetsu Sangokushi\",\"russian\":\"Стальные хроники Троецарствия\",\"image\":{\"original\":\"/system/mangas/original/42629.jpg?1675155018\",\"preview\":\"/system/mangas/preview/42629.jpg?1675155018\",\"x96\":\"/system/mangas/x96/42629.jpg?1675155018\",\"x48\":\"/system/mangas/x48/42629.jpg?1675155018\"},\"url\":\"/mangas/42629-koutetsu-sangokushi\",\"kind\":\"manga\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":1,\"chapters\":4,\"aired_on\":\"2007-01-01\",\"released_on\":null},{\"id\":99874,\"name\":\"Buster Dress\",\"russian\":\"Стальная броня\",\"image\":{\"original\":\"/system/mangas/original/99874.jpg?1675198972\",\"preview\":\"/system/mangas/preview/99874.jpg?1675198972\",\"x96\":\"/system/mangas/x96/99874.jpg?1675198972\",\"x48\":\"/system/mangas/x48/99874.jpg?1675198972\"},\"url\":\"/mangas/99874-buster-dress\",\"kind\":\"manga\",\"score\":\"6.69\",\"status\":\"released\",\"volumes\":4,\"chapters\":20,\"aired_on\":\"2016-04-09\",\"released_on\":\"2018-01-09\"},{\"id\":103739,\"name\":\"Fullmetal Lady\",\"russian\":\"Стальная леди\",\"image\":{\"original\":\"/system/mangas/original/103739.jpg?1675201371\",\"preview\":\"/system/mangas/preview/103739.jpg?1675201371\",\"x96\":\"/system/mangas/x96/103739.jpg?1675201371\",\"x48\":\"/system/mangas/x48/103739.jpg?1675201371\"},\"url\":\"/mangas/103739-fullmetal-lady\",\"kind\":\"manga\",\"score\":\"5.45\",\"status\":\"released\",\"volumes\":1,\"chapters\":4,\"aired_on\":\"1988-01-01\",\"released_on\":\"1989-01-01\"},{\"id\":92894,\"name\":\"Kurogane no Linebarrel 0\",\"russian\":\"Стальной Лайнбаррель: Пилотная глава\",\"image\":{\"original\":\"/system/mangas/original/92894.jpg?1675194718\",\"preview\":\"/system/mangas/preview/92894.jpg?1675194718\",\"x96\":\"/system/mangas/x96/92894.jpg?1675194718\",\"x48\":\"/system/mangas/x48/92894.jpg?1675194718\"},\"url\":\"/mangas/92894-kurogane-no-linebarrel-0\",\"kind\":\"manga\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":1,\"chapters\":8,\"aired_on\":\"2004-06-01\",\"released_on\":\"2006-09-19\"},{\"id\":22697,\"name\":\"Full Metal Panic! Comic Mission\",\"russian\":\"Стальная тревога: Комическая миссия\",\"image\":{\"original\":\"/system/mangas/original/22697.jpg?1675147212\",\"preview\":\"/system/mangas/preview/22697.jpg?1675147212\",\"x96\":\"/system/mangas/x96/22697.jpg?1675147212\",\"x48\":\"/system/mangas/x48/22697.jpg?1675147212\"},\"url\":\"/mangas/22697-full-metal-panic-comic-mission\",\"kind\":\"manga\",\"score\":\"7.26\",\"status\":\"released\",\"volumes\":7,\"chapters\":60,\"aired_on\":\"2003-01-01\",\"released_on\":\"2006-01-01\"},{\"id\":19682,\"name\":\"Full Metal Panic! Surplus\",\"russian\":\"Стальная тревога: Дополнение\",\"image\":{\"original\":\"/system/mangas/original/19682.jpg?1675144540\",\"preview\":\"/system/mangas/preview/19682.jpg?1675144540\",\"x96\":\"/system/mangas/x96/19682.jpg?1675144540\",\"x48\":\"/system/mangas/x48/19682.jpg?1675144540\"},\"url\":\"/mangas/19682-full-metal-panic-surplus\",\"kind\":\"manga\",\"score\":\"6.67\",\"status\":\"released\",\"volumes\":1,\"chapters\":4,\"aired_on\":\"2003-07-01\",\"released_on\":null},{\"id\":13020,\"name\":\"Kurogane Pukapuka-tai\",\"russian\":\"Стальной крейсер\",\"image\":{\"original\":\"/system/mangas/original/13020.jpg?1682908715\",\"preview\":\"/system/mangas/preview/13020.jpg?1682908715\",\"x96\":\"/system/mangas/x96/13020.jpg?1682908715\",\"x48\":\"/system/mangas/x48/13020.jpg?1682908715\"},\"url\":\"/mangas/13020-kurogane-pukapuka-tai\",\"kind\":\"manga\",\"score\":\"7.16\",\"status\":\"ongoing\",\"volumes\":0,\"chapters\":0,\"aired_on\":\"2006-06-20\",\"released_on\":null},{\"id\":10818,\"name\":\"Steel Rose\",\"russian\":\"Стальная роза\",\"image\":{\"original\":\"/system/mangas/original/10818.jpg?1675139221\",\"preview\":\"/system/mangas/preview/10818.jpg?1675139221\",\"x96\":\"/system/mangas/x96/10818.jpg?1675139221\",\"x48\":\"/system/mangas/x48/10818.jpg?1675139221\"},\"url\":\"/mangas/10818-steel-rose\",\"kind\":\"manhua\",\"score\":\"7.16\",\"status\":\"released\",\"volumes\":7,\"chapters\":36,\"aired_on\":\"2004-01-01\",\"released_on\":\"2007-01-01\"},{\"id\":11006,\"name\":\"Kenkou Shoujo Riku\",\"russian\":\"Стальной кулак Рику\",\"image\":{\"original\":\"/system/mangas/original/11006.jpg?1675139418\",\"preview\":\"/system/mangas/preview/11006.jpg?1675139418\",\"x96\":\"/system/mangas/x96/11006.jpg?1675139418\",\"x48\":\"/system/mangas/x48/11006.jpg?1675139418\"},\"url\":\"/mangas/11006-kenkou-shoujo-riku\",\"kind\":\"manga\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":3,\"chapters\":16,\"aired_on\":\"2006-04-12\",\"released_on\":\"2008-05-14\"},{\"id\":10600,\"name\":\"Metal Fight Beyblade\",\"russian\":\"Стальной воин бэйблэйд\",\"image\":{\"original\":\"/system/mangas/original/10600.jpg?1675139023\",\"preview\":\"/system/mangas/preview/10600.jpg?1675139023\",\"x96\":\"/system/mangas/x96/10600.jpg?1675139023\",\"x48\":\"/system/mangas/x48/10600.jpg?1675139023\"},\"url\":\"/mangas/10600-metal-fight-beyblade\",\"kind\":\"manga\",\"score\":\"6.51\",\"status\":\"released\",\"volumes\":11,\"chapters\":0,\"aired_on\":\"2008-09-13\",\"released_on\":\"2012-02-15\"},{\"id\":3414,\"name\":\"Koutetsu Tenshi Kurumi\",\"russian\":\"Стальной ангел Куруми\",\"image\":{\"original\":\"/system/mangas/original/3414.jpg?1675132517\",\"preview\":\"/system/mangas/preview/3414.jpg?1675132517\",\"x96\":\"/system/mangas/x96/3414.jpg?1675132517\",\"x48\":\"/system/mangas/x48/3414.jpg?1675132517\"},\"url\":\"/mangas/3414-koutetsu-tenshi-kurumi\",\"kind\":\"manga\",\"score\":\"6.76\",\"status\":\"released\",\"volumes\":11,\"chapters\":69,\"aired_on\":\"1997-10-03\",\"released_on\":\"2003-12-26\"},{\"id\":3638,\"name\":\"Kurogane no Linebarrel\",\"russian\":\"Стальной Лайнбаррель\",\"image\":{\"original\":\"/system/mangas/original/3638.jpg?1675132819\",\"preview\":\"/system/mangas/preview/3638.jpg?1675132819\",\"x96\":\"/system/mangas/x96/3638.jpg?1675132819\",\"x48\":\"/system/mangas/x48/3638.jpg?1675132819\"},\"url\":\"/mangas/3638-kurogane-no-linebarrel\",\"kind\":\"manga\",\"score\":\"7.09\",\"status\":\"released\",\"volumes\":25,\"chapters\":128,\"aired_on\":\"2004-12-18\",\"released_on\":\"2015-04-18\"},{\"id\":76185,\"name\":\"Koutetsu no Shinigami: Michael Wittmann Senki\",\"russian\":\"Стальной жнец смерти: Хроники Михаэля Виттмана\",\"image\":{\"original\":\"/system/mangas/original/76185.jpg?1675183068\",\"preview\":\"/system/mangas/preview/76185.jpg?1675183068\",\"x96\":\"/system/mangas/x96/76185.jpg?1675183068\",\"x48\":\"/system/mangas/x48/76185.jpg?1675183068\"},\"url\":\"/mangas/76185-koutetsu-no-shinigami-michael-wittmann-senki\",\"kind\":\"manga\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":1,\"chapters\":0,\"aired_on\":\"1995-04-01\",\"released_on\":null},{\"id\":80049,\"name\":\"Steel Rain\",\"russian\":\"Стальной дождь\",\"image\":{\"original\":\"/system/mangas/original/80049.jpg?1675185710\",\"preview\":\"/system/mangas/preview/80049.jpg?1675185710\",\"x96\":\"/system/mangas/x96/80049.jpg?1675185710\",\"x48\":\"/system/mangas/x48/80049.jpg?1675185710\"},\"url\":\"/mangas/80049-steel-rain\",\"kind\":\"manhwa\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":2,\"chapters\":32,\"aired_on\":\"2011-05-05\",\"released_on\":\"2011-12-01\"},{\"id\":71645,\"name\":\"Full Metal Panic! 0\",\"russian\":\"Стальная тревога: Начало\",\"image\":{\"original\":\"/system/mangas/original/71645.jpg?1682932471\",\"preview\":\"/system/mangas/preview/71645.jpg?1682932471\",\"x96\":\"/system/mangas/x96/71645.jpg?1682932471\",\"x48\":\"/system/mangas/x48/71645.jpg?1682932471\"},\"url\":\"/mangas/71645-full-metal-panic-0\",\"kind\":\"manga\",\"score\":\"0.0\",\"status\":\"ongoing\",\"volumes\":0,\"chapters\":0,\"aired_on\":\"2013-09-19\",\"released_on\":null},{\"id\":30723,\"name\":\"Koutetsu Jeeg\",\"russian\":\"Стальной Джиг\",\"image\":{\"original\":\"/system/mangas/original/30723.jpg?1675150845\",\"preview\":\"/system/mangas/preview/30723.jpg?1675150845\",\"x96\":\"/system/mangas/x96/30723.jpg?1675150845\",\"x48\":\"/system/mangas/x48/30723.jpg?1675150845\"},\"url\":\"/mangas/30723-koutetsu-jeeg\",\"kind\":\"manga\",\"score\":\"6.11\",\"status\":\"released\",\"volumes\":1,\"chapters\":10,\"aired_on\":\"1975-09-01\",\"released_on\":\"1976-07-01\"},{\"id\":30741,\"name\":\"Full Metal Panic! Another\",\"russian\":\"Стальная тревога: Другая история\",\"image\":{\"original\":\"/system/mangas/original/30741.jpg?1675150852\",\"preview\":\"/system/mangas/preview/30741.jpg?1675150852\",\"x96\":\"/system/mangas/x96/30741.jpg?1675150852\",\"x48\":\"/system/mangas/x48/30741.jpg?1675150852\"},\"url\":\"/mangas/30741-full-metal-panic-another\",\"kind\":\"manga\",\"score\":\"6.87\",\"status\":\"released\",\"volumes\":6,\"chapters\":34,\"aired_on\":\"2011-10-08\",\"released_on\":\"2014-07-29\"},{\"id\":153208,\"name\":\"Koutetsu Jeeg\",\"russian\":\"Стальной Джиг\",\"image\":{\"original\":\"/system/mangas/original/153208.jpg?1685923797\",\"preview\":\"/system/mangas/preview/153208.jpg?1685923797\",\"x96\":\"/system/mangas/x96/153208.jpg?1685923797\",\"x48\":\"/system/mangas/x48/153208.jpg?1685923797\"},\"url\":\"/mangas/153208-koutetsu-jeeg\",\"kind\":\"manga\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":2,\"chapters\":10,\"aired_on\":\"1975-07-01\",\"released_on\":\"1976-05-01\"},{\"id\":138989,\"name\":\"Kurogane no Bara\",\"russian\":\"Стальная роза\",\"image\":{\"original\":\"/system/mangas/original/138989.jpg?1682966534\",\"preview\":\"/system/mangas/preview/138989.jpg?1682966534\",\"x96\":\"/system/mangas/x96/138989.jpg?1682966534\",\"x48\":\"/system/mangas/x48/138989.jpg?1682966534\"},\"url\":\"/mangas/138989-kurogane-no-bara\",\"kind\":\"manga\",\"score\":\"0.0\",\"status\":\"ongoing\",\"volumes\":0,\"chapters\":0,\"aired_on\":\"2021-06-18\",\"released_on\":null},{\"id\":127482,\"name\":\"Taiyou to Tsuki no Hagane\",\"russian\":\"Сталь луны и солнца\",\"image\":{\"original\":\"/system/mangas/original/127482.jpg?1682961112\",\"preview\":\"/system/mangas/preview/127482.jpg?1682961112\",\"x96\":\"/system/mangas/x96/127482.jpg?1682961112\",\"x48\":\"/system/mangas/x48/127482.jpg?1682961112\"},\"url\":\"/mangas/127482-taiyou-to-tsuki-no-hagane\",\"kind\":\"manga\",\"score\":\"7.12\",\"status\":\"ongoing\",\"volumes\":0,\"chapters\":0,\"aired_on\":\"2020-06-12\",\"released_on\":null},{\"id\":1598,\"name\":\"Kurogane\",\"russian\":\"Чёрная сталь\",\"image\":{\"original\":\"/system/mangas/original/1598.jpg?1675129754\",\"preview\":\"/system/mangas/preview/1598.jpg?1675129754\",\"x96\":\"/system/mangas/x96/1598.jpg?1675129754\",\"x48\":\"/system/mangas/x48/1598.jpg?1675129754\"},\"url\":\"/mangas/1598-kurogane\",\"kind\":\"manga\",\"score\":\"7.18\",\"status\":\"released\",\"volumes\":5,\"chapters\":38,\"aired_on\":\"1993-11-25\",\"released_on\":\"2001-08-30\"},{\"id\":937,\"name\":\"Ikinari! Full Metal Panic!\",\"russian\":\"Внезапно! Стальная тревога!\",\"image\":{\"original\":\"/system/mangas/original/937.jpg?1675128646\",\"preview\":\"/system/mangas/preview/937.jpg?1675128646\",\"x96\":\"/system/mangas/x96/937.jpg?1675128646\",\"x48\":\"/system/mangas/x48/937.jpg?1675128646\"},\"url\":\"/mangas/937-ikinari-full-metal-panic\",\"kind\":\"manga\",\"score\":\"7.28\",\"status\":\"released\",\"volumes\":5,\"chapters\":29,\"aired_on\":\"2001-01-30\",\"released_on\":\"2003-04-01\"},{\"id\":27765,\"name\":\"Blood and Steel\",\"russian\":\"Кровь и сталь\",\"image\":{\"original\":\"/system/mangas/original/27765.jpg?1682918520\",\"preview\":\"/system/mangas/preview/27765.jpg?1682918520\",\"x96\":\"/system/mangas/x96/27765.jpg?1682918520\",\"x48\":\"/system/mangas/x48/27765.jpg?1682918520\"},\"url\":\"/mangas/27765-blood-and-steel\",\"kind\":\"manhua\",\"score\":\"7.47\",\"status\":\"ongoing\",\"volumes\":0,\"chapters\":0,\"aired_on\":\"2011-04-15\",\"released_on\":null},{\"id\":109977,\"name\":\"Kurogane Kai\",\"russian\":\"Чёрная сталь: Пересмотр\",\"image\":{\"original\":\"/system/mangas/original/109977.jpg?1675205996\",\"preview\":\"/system/mangas/preview/109977.jpg?1675205996\",\"x96\":\"/system/mangas/x96/109977.jpg?1675205996\",\"x48\":\"/system/mangas/x48/109977.jpg?1675205996\"},\"url\":\"/mangas/109977-kurogane-kai\",\"kind\":\"manga\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":5,\"chapters\":39,\"aired_on\":\"2016-11-02\",\"released_on\":\"2020-10-21\"},{\"id\":26903,\"name\":\"Plug: Full Metal Idol\",\"russian\":\"Плаг: Стальной идол\",\"image\":{\"original\":\"/system/mangas/original/26903.jpg?1675149847\",\"preview\":\"/system/mangas/preview/26903.jpg?1675149847\",\"x96\":\"/system/mangas/x96/26903.jpg?1675149847\",\"x48\":\"/system/mangas/x48/26903.jpg?1675149847\"},\"url\":\"/mangas/26903-plug-full-metal-idol\",\"kind\":\"manga\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":5,\"chapters\":0,\"aired_on\":\"2011-05-25\",\"released_on\":\"2013-04-25\"},{\"id\":29827,\"name\":\"Dare ga Tame ni Hagane wa Naru\",\"russian\":\"По ком звонит сталь\",\"image\":{\"original\":\"/system/mangas/original/29827.jpg?1675150664\",\"preview\":\"/system/mangas/preview/29827.jpg?1675150664\",\"x96\":\"/system/mangas/x96/29827.jpg?1675150664\",\"x48\":\"/system/mangas/x48/29827.jpg?1675150664\"},\"url\":\"/mangas/29827-dare-ga-tame-ni-hagane-wa-naru\",\"kind\":\"manga\",\"score\":\"6.7\",\"status\":\"released\",\"volumes\":1,\"chapters\":7,\"aired_on\":\"2009-02-14\",\"released_on\":\"2010-06-15\"},{\"id\":97916,\"name\":\"Koutetsujou no Kabaneri\",\"russian\":\"Кабанэри железной крепости\",\"image\":{\"original\":\"/system/mangas/original/97916.jpg?1675197479\",\"preview\":\"/system/mangas/preview/97916.jpg?1675197479\",\"x96\":\"/system/mangas/x96/97916.jpg?1675197479\",\"x48\":\"/system/mangas/x48/97916.jpg?1675197479\"},\"url\":\"/mangas/97916-koutetsujou-no-kabaneri\",\"kind\":\"manga\",\"score\":\"7.62\",\"status\":\"released\",\"volumes\":4,\"chapters\":28,\"aired_on\":\"2016-05-02\",\"released_on\":\"2018-11-05\"},{\"id\":92104,\"name\":\"Hana to Kurogane\",\"russian\":\"Цветок и чёрная сталь\",\"image\":{\"original\":\"/system/mangas/original/92104.jpg?1675194440\",\"preview\":\"/system/mangas/preview/92104.jpg?1675194440\",\"x96\":\"/system/mangas/x96/92104.jpg?1675194440\",\"x48\":\"/system/mangas/x48/92104.jpg?1675194440\"},\"url\":\"/mangas/92104-hana-to-kurogane\",\"kind\":\"manga\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":4,\"chapters\":28,\"aired_on\":\"2014-10-06\",\"released_on\":\"2018-08-06\"},{\"id\":71693,\"name\":\"M3: Sono Kuroki Hagane\",\"russian\":\"М3: Эта чёрная сталь\",\"image\":{\"original\":\"/system/mangas/original/71693.jpg?1675178014\",\"preview\":\"/system/mangas/preview/71693.jpg?1675178014\",\"x96\":\"/system/mangas/x96/71693.jpg?1675178014\",\"x48\":\"/system/mangas/x48/71693.jpg?1675178014\"},\"url\":\"/mangas/71693-m3-sono-kuroki-hagane\",\"kind\":\"manga\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":2,\"chapters\":10,\"aired_on\":\"2014-04-30\",\"released_on\":\"2015-06-05\"},{\"id\":97524,\"name\":\"Kidou Senshi Gundam: Tekketsu no Orphans - Gekkou\",\"russian\":\"Гандам: Железнокровные сироты — Лунная сталь\",\"image\":{\"original\":\"/system/mangas/original/97524.jpg?1675197213\",\"preview\":\"/system/mangas/preview/97524.jpg?1675197213\",\"x96\":\"/system/mangas/x96/97524.jpg?1675197213\",\"x48\":\"/system/mangas/x48/97524.jpg?1675197213\"},\"url\":\"/mangas/97524-kidou-senshi-gundam-tekketsu-no-orphans-gekkou\",\"kind\":\"manga\",\"score\":\"7.14\",\"status\":\"released\",\"volumes\":4,\"chapters\":18,\"aired_on\":\"2016-04-26\",\"released_on\":\"2018-03-26\"},{\"id\":102492,\"name\":\"Shitto na Watashi to Sick na Aitsu\",\"russian\":\"\",\"image\":{\"original\":\"/system/mangas/original/102492.jpg?1675200887\",\"preview\":\"/system/mangas/preview/102492.jpg?1675200887\",\"x96\":\"/system/mangas/x96/102492.jpg?1675200887\",\"x48\":\"/system/mangas/x48/102492.jpg?1675200887\"},\"url\":\"/mangas/102492-shitto-na-watashi-to-sick-na-aitsu\",\"kind\":\"one_shot\",\"score\":\"6.1\",\"status\":\"released\",\"volumes\":0,\"chapters\":1,\"aired_on\":\"2016-02-27\",\"released_on\":null},{\"id\":3286,\"name\":\"Koukou Tekkenden Tough\",\"russian\":\"Крепыш: Стальной кулак в школе\",\"image\":{\"original\":\"/system/mangas/original/3286.jpg?1675132376\",\"preview\":\"/system/mangas/preview/3286.jpg?1675132376\",\"x96\":\"/system/mangas/x96/3286.jpg?1675132376\",\"x48\":\"/system/mangas/x48/3286.jpg?1675132376\"},\"url\":\"/mangas/3286-koukou-tekkenden-tough\",\"kind\":\"manga\",\"score\":\"7.52\",\"status\":\"released\",\"volumes\":42,\"chapters\":474,\"aired_on\":\"1993-07-22\",\"released_on\":\"2003-06-19\"},{\"id\":1706,\"name\":\"JoJo no Kimyou na Bouken Part 7: Steel Ball Run\",\"russian\":\"Невероятное приключение ДжоДжо — Часть 7: Гонка «Стальной шар»\",\"image\":{\"original\":\"/system/mangas/original/1706.jpg?1675129904\",\"preview\":\"/system/mangas/preview/1706.jpg?1675129904\",\"x96\":\"/system/mangas/x96/1706.jpg?1675129904\",\"x48\":\"/system/mangas/x48/1706.jpg?1675129904\"},\"url\":\"/mangas/1706-jojo-no-kimyou-na-bouken-part-7-steel-ball-run\",\"kind\":\"manga\",\"score\":\"9.29\",\"status\":\"released\",\"volumes\":24,\"chapters\":96,\"aired_on\":\"2004-01-19\",\"released_on\":\"2011-04-19\"},{\"id\":47861,\"name\":\"Nostalgia\",\"russian\":\"Ностальгия\",\"image\":{\"original\":\"/system/mangas/original/47861.jpg?1675157177\",\"preview\":\"/system/mangas/preview/47861.jpg?1675157177\",\"x96\":\"/system/mangas/x96/47861.jpg?1675157177\",\"x48\":\"/system/mangas/x48/47861.jpg?1675157177\"},\"url\":\"/mangas/47861-nostalgia\",\"kind\":\"one_shot\",\"score\":\"6.68\",\"status\":\"released\",\"volumes\":0,\"chapters\":1,\"aired_on\":\"2011-12-24\",\"released_on\":null},{\"id\":16467,\"name\":\"Nostalgio no Kaze\",\"russian\":\"Ностальгия\",\"image\":{\"original\":\"/system/mangas/original/16467.jpg?1675142446\",\"preview\":\"/system/mangas/preview/16467.jpg?1675142446\",\"x96\":\"/system/mangas/x96/16467.jpg?1675142446\",\"x48\":\"/system/mangas/x48/16467.jpg?1675142446\"},\"url\":\"/mangas/16467-nostalgio-no-kaze\",\"kind\":\"manga\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":2,\"chapters\":0,\"aired_on\":\"2008-10-01\",\"released_on\":\"2008-12-01\"},{\"id\":9196,\"name\":\"Nostalgia\",\"russian\":\"Ностальгия\",\"image\":{\"original\":\"/system/mangas/original/9196.jpg?1675137873\",\"preview\":\"/system/mangas/preview/9196.jpg?1675137873\",\"x96\":\"/system/mangas/x96/9196.jpg?1675137873\",\"x48\":\"/system/mangas/x48/9196.jpg?1675137873\"},\"url\":\"/mangas/9196-nostalgia\",\"kind\":\"manga\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":1,\"chapters\":4,\"aired_on\":\"2008-01-01\",\"released_on\":null},{\"id\":49667,\"name\":\"Shoujo Nostalgica\",\"russian\":\"Девичья ностальгия\",\"image\":{\"original\":\"/system/mangas/original/49667.jpg?1675158180\",\"preview\":\"/system/mangas/preview/49667.jpg?1675158180\",\"x96\":\"/system/mangas/x96/49667.jpg?1675158180\",\"x48\":\"/system/mangas/x48/49667.jpg?1675158180\"},\"url\":\"/mangas/49667-shoujo-nostalgica\",\"kind\":\"manga\",\"score\":\"6.73\",\"status\":\"released\",\"volumes\":1,\"chapters\":10,\"aired_on\":\"2010-12-09\",\"released_on\":\"2012-07-23\"},{\"id\":55179,\"name\":\"Crystal Palace\",\"russian\":\"Хрустальный дворец\",\"image\":{\"original\":\"/system/mangas/original/55179.jpg?1675162055\",\"preview\":\"/system/mangas/preview/55179.jpg?1675162055\",\"x96\":\"/system/mangas/x96/55179.jpg?1675162055\",\"x48\":\"/system/mangas/x48/55179.jpg?1675162055\"},\"url\":\"/mangas/55179-crystal-palace\",\"kind\":\"manga\",\"score\":\"6.39\",\"status\":\"released\",\"volumes\":1,\"chapters\":6,\"aired_on\":\"2011-01-01\",\"released_on\":null},{\"id\":110278,\"name\":\"Crystal Days\",\"russian\":\"Кристальные дни\",\"image\":{\"original\":\"/system/mangas/original/110278.jpg?1675206142\",\"preview\":\"/system/mangas/preview/110278.jpg?1675206142\",\"x96\":\"/system/mangas/x96/110278.jpg?1675206142\",\"x48\":\"/system/mangas/x48/110278.jpg?1675206142\"},\"url\":\"/mangas/110278-crystal-days\",\"kind\":\"manga\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":4,\"chapters\":25,\"aired_on\":\"2014-09-30\",\"released_on\":\"2016-10-31\"},{\"id\":24776,\"name\":\"Kesshou Monogatari\",\"russian\":\"Кристальные истории\",\"image\":{\"original\":\"/system/mangas/original/24776.jpg?1675148758\",\"preview\":\"/system/mangas/preview/24776.jpg?1675148758\",\"x96\":\"/system/mangas/x96/24776.jpg?1675148758\",\"x48\":\"/system/mangas/x48/24776.jpg?1675148758\"},\"url\":\"/mangas/24776-kesshou-monogatari\",\"kind\":\"manga\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":5,\"chapters\":34,\"aired_on\":\"2008-03-28\",\"released_on\":\"2013-02-28\"},{\"id\":25674,\"name\":\"Glass Shoes\",\"russian\":\"Хрустальная туфелька\",\"image\":{\"original\":\"/system/mangas/original/25674.jpg?1675149230\",\"preview\":\"/system/mangas/preview/25674.jpg?1675149230\",\"x96\":\"/system/mangas/x96/25674.jpg?1675149230\",\"x48\":\"/system/mangas/x48/25674.jpg?1675149230\"},\"url\":\"/mangas/25674-glass-shoes\",\"kind\":\"manhwa\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":3,\"chapters\":0,\"aired_on\":\"2008-01-01\",\"released_on\":null},{\"id\":16389,\"name\":\"Crystal Prelude\",\"russian\":\"Кристальная прелюдия\",\"image\":{\"original\":\"/system/mangas/original/16389.jpg?1675142437\",\"preview\":\"/system/mangas/preview/16389.jpg?1675142437\",\"x96\":\"/system/mangas/x96/16389.jpg?1675142437\",\"x48\":\"/system/mangas/x48/16389.jpg?1675142437\"},\"url\":\"/mangas/16389-crystal-prelude\",\"kind\":\"manga\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":1,\"chapters\":3,\"aired_on\":\"1999-01-01\",\"released_on\":null}]";

            string result = await httpClient.GetStringAsync($"/api/mangas?search={searchManga}&limit=50");

            Assert.AreEqual(expectedResult, result);
            httpClient.Dispose();
        }
        /// <summary>
        /// Данный тест проверят корректность полученных данных
        /// со стороны
        /// </summary>
        [TestMethod]
        public async Task GetRanobeTest_SearchRanobe()
        {
            RanobeModel mangaModel = new RanobeModel(_httpClientFactory, _httpContextAccessor);

            string searchRanobe = "Сталь";

            HttpClient httpClient = new HttpClient();
            httpClient.BaseAddress = new Uri("https://shikimori.me");
            httpClient.DefaultRequestHeaders.Authorization = new System.Net.Http.Headers.AuthenticationHeaderValue("User-Agent", "ShikiOAuthTest");

            string expectedResult = "[{\"id\":4658,\"name\":\"Fullmetal Alchemist\",\"russian\":\"Стальной алхимик\",\"image\":{\"original\":\"/system/mangas/original/4658.jpg?1675133782\",\"preview\":\"/system/mangas/preview/4658.jpg?1675133782\",\"x96\":\"/system/mangas/x96/4658.jpg?1675133782\",\"x48\":\"/system/mangas/x48/4658.jpg?1675133782\"},\"url\":\"/mangas/4658-fullmetal-alchemist\",\"kind\":\"light_novel\",\"score\":\"8.46\",\"status\":\"released\",\"volumes\":7,\"chapters\":35,\"aired_on\":\"2003-02-01\",\"released_on\":\"2010-04-22\"},{\"id\":7533,\"name\":\"Chrome Shelled Regios\",\"russian\":\"Хромированный Региос\",\"image\":{\"original\":\"/system/mangas/original/7533.jpg?1675136187\",\"preview\":\"/system/mangas/preview/7533.jpg?1675136187\",\"x96\":\"/system/mangas/x96/7533.jpg?1675136187\",\"x48\":\"/system/mangas/x48/7533.jpg?1675136187\"},\"url\":\"/mangas/7533-chrome-shelled-regios\",\"kind\":\"light_novel\",\"score\":\"7.73\",\"status\":\"released\",\"volumes\":25,\"chapters\":157,\"aired_on\":\"2006-03-18\",\"released_on\":\"2013-09-20\"},{\"id\":10892,\"name\":\"Full Metal Panic!\",\"russian\":\"Стальная тревога!\",\"image\":{\"original\":\"/system/mangas/original/10892.jpg?1675139298\",\"preview\":\"/system/mangas/preview/10892.jpg?1675139298\",\"x96\":\"/system/mangas/x96/10892.jpg?1675139298\",\"x48\":\"/system/mangas/x48/10892.jpg?1675139298\"},\"url\":\"/mangas/10892-full-metal-panic\",\"kind\":\"light_novel\",\"score\":\"8.16\",\"status\":\"released\",\"volumes\":12,\"chapters\":72,\"aired_on\":\"1998-09-09\",\"released_on\":\"2011-08-20\"},{\"id\":28485,\"name\":\"Full Metal Panic! Another\",\"russian\":\"Стальная тревога: Другая история\",\"image\":{\"original\":\"/system/mangas/original/28485.jpg?1675150305\",\"preview\":\"/system/mangas/preview/28485.jpg?1675150305\",\"x96\":\"/system/mangas/x96/28485.jpg?1675150305\",\"x48\":\"/system/mangas/x48/28485.jpg?1675150305\"},\"url\":\"/mangas/28485-full-metal-panic-another\",\"kind\":\"light_novel\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":12,\"chapters\":54,\"aired_on\":\"2011-08-20\",\"released_on\":\"2016-02-20\"},{\"id\":37371,\"name\":\"Full Metal Panic! Tanpenshuu\",\"russian\":\"Стальная тревога: Короткие истории\",\"image\":{\"original\":\"/system/mangas/original/37371.jpg?1675152876\",\"preview\":\"/system/mangas/preview/37371.jpg?1675152876\",\"x96\":\"/system/mangas/x96/37371.jpg?1675152876\",\"x48\":\"/system/mangas/x48/37371.jpg?1675152876\"},\"url\":\"/mangas/37371-full-metal-panic-tanpenshuu\",\"kind\":\"light_novel\",\"score\":\"7.5\",\"status\":\"released\",\"volumes\":9,\"chapters\":51,\"aired_on\":\"1998-05-30\",\"released_on\":\"2010-01-20\"},{\"id\":37373,\"name\":\"Full Metal Panic! Side Arms\",\"russian\":\"Стальная тревога: Другое оружие\",\"image\":{\"original\":\"/system/mangas/original/37373.jpg?1675152919\",\"preview\":\"/system/mangas/preview/37373.jpg?1675152919\",\"x96\":\"/system/mangas/x96/37373.jpg?1675152919\",\"x48\":\"/system/mangas/x48/37373.jpg?1675152919\"},\"url\":\"/mangas/37373-full-metal-panic-side-arms\",\"kind\":\"light_novel\",\"score\":\"0.0\",\"status\":\"released\",\"volumes\":2,\"chapters\":9,\"aired_on\":\"2001-12-28\",\"released_on\":\"2005-11-30\"},{\"id\":98575,\"name\":\"Koutetsujou no Kabaneri\",\"russian\":\"Кабанэри железной крепости\",\"image\":{\"original\":\"/system/mangas/original/98575.jpg?1675197847\",\"preview\":\"/system/mangas/preview/98575.jpg?1675197847\",\"x96\":\"/system/mangas/x96/98575.jpg?1675197847\",\"x48\":\"/system/mangas/x48/98575.jpg?1675197847\"},\"url\":\"/mangas/98575-koutetsujou-no-kabaneri\",\"kind\":\"light_novel\",\"score\":\"7.61\",\"status\":\"released\",\"volumes\":2,\"chapters\":0,\"aired_on\":\"2016-07-09\",\"released_on\":\"2016-08-10\"},{\"id\":98576,\"name\":\"Koutetsujou no Kabaneri: Akatsuki\",\"russian\":\"Кабанэри железной крепости: Рассвет\",\"image\":{\"original\":\"/system/mangas/original/98576.jpg?1675197826\",\"preview\":\"/system/mangas/preview/98576.jpg?1675197826\",\"x96\":\"/system/mangas/x96/98576.jpg?1675197826\",\"x48\":\"/system/mangas/x48/98576.jpg?1675197826\"},\"url\":\"/mangas/98576-koutetsujou-no-kabaneri-akatsuki\",\"kind\":\"light_novel\",\"score\":\"7.5\",\"status\":\"released\",\"volumes\":1,\"chapters\":6,\"aired_on\":\"2016-06-10\",\"released_on\":null}]";

            var result = await httpClient.GetStringAsync($"/api/ranobe?search={searchRanobe}&limit=50");

            Assert.AreEqual(expectedResult, result);
            httpClient.Dispose();
        }
        /// <summary>
        /// Данный тест проверят корректность полученных данных
        /// со стороны
        /// </summary>
        [TestMethod]
        public async Task GetAnimesTest_SearchAnime()
        {
            MainAnimePageModel animeModel = new MainAnimePageModel(_httpClientFactory, _httpContextAccessor);

            string searchAnime = "Сталь";

            HttpClient httpClient = new HttpClient();
            httpClient.BaseAddress = new Uri("https://shikimori.me");
            httpClient.DefaultRequestHeaders.Authorization = new System.Net.Http.Headers.AuthenticationHeaderValue("User-Agent", "ShikiOAuthTest");

            string expectedResult = "[{\"id\":3653,\"name\":\"Kurogane no Linebarrels\",\"russian\":\"Стальные Лайнбаррели\",\"image\":{\"original\":\"/system/animes/original/3653.jpg?1674347157\",\"preview\":\"/system/animes/preview/3653.jpg?1674347157\",\"x96\":\"/system/animes/x96/3653.jpg?1674347157\",\"x48\":\"/system/animes/x48/3653.jpg?1674347157\"},\"url\":\"/animes/3653-kurogane-no-linebarrels\",\"kind\":\"tv\",\"score\":\"6.9\",\"status\":\"released\",\"episodes\":24,\"episodes_aired\":0,\"aired_on\":\"2008-10-03\",\"released_on\":\"2009-03-20\"},{\"id\":4198,\"name\":\"Koutetsu Jeeg\",\"russian\":\"Стальной Джиг\",\"image\":{\"original\":\"/system/animes/original/4198.jpg?1674348352\",\"preview\":\"/system/animes/preview/4198.jpg?1674348352\",\"x96\":\"/system/animes/x96/4198.jpg?1674348352\",\"x48\":\"/system/animes/x48/4198.jpg?1674348352\"},\"url\":\"/animes/4198-koutetsu-jeeg\",\"kind\":\"tv\",\"score\":\"7.06\",\"status\":\"released\",\"episodes\":46,\"episodes_aired\":0,\"aired_on\":\"1975-10-05\",\"released_on\":\"1976-08-29\"},{\"id\":5114,\"name\":\"Fullmetal Alchemist: Brotherhood\",\"russian\":\"Стальной алхимик: Братство\",\"image\":{\"original\":\"/system/animes/original/5114.jpg?1674349719\",\"preview\":\"/system/animes/preview/5114.jpg?1674349719\",\"x96\":\"/system/animes/x96/5114.jpg?1674349719\",\"x48\":\"/system/animes/x48/5114.jpg?1674349719\"},\"url\":\"/animes/z5114-fullmetal-alchemist-brotherhood\",\"kind\":\"tv\",\"score\":\"9.1\",\"status\":\"released\",\"episodes\":64,\"episodes_aired\":0,\"aired_on\":\"2009-04-05\",\"released_on\":\"2010-07-04\"},{\"id\":2157,\"name\":\"Koutetsushin Jeeg\",\"russian\":\"Стальной Джиг (2007)\",\"image\":{\"original\":\"/system/animes/original/2157.jpg?1674342637\",\"preview\":\"/system/animes/preview/2157.jpg?1674342637\",\"x96\":\"/system/animes/x96/2157.jpg?1674342637\",\"x48\":\"/system/animes/x48/2157.jpg?1674342637\"},\"url\":\"/animes/2157-koutetsushin-jeeg\",\"kind\":\"tv\",\"score\":\"6.88\",\"status\":\"released\",\"episodes\":13,\"episodes_aired\":0,\"aired_on\":\"2007-04-05\",\"released_on\":\"2007-07-12\"},{\"id\":2162,\"name\":\"Koutetsu Sangokushi\",\"russian\":\"Стальные хроники царств\",\"image\":{\"original\":\"/system/animes/original/2162.jpg?1674342644\",\"preview\":\"/system/animes/preview/2162.jpg?1674342644\",\"x96\":\"/system/animes/x96/2162.jpg?1674342644\",\"x48\":\"/system/animes/x48/2162.jpg?1674342644\"},\"url\":\"/animes/2162-koutetsu-sangokushi\",\"kind\":\"tv\",\"score\":\"6.28\",\"status\":\"released\",\"episodes\":25,\"episodes_aired\":0,\"aired_on\":\"2007-04-06\",\"released_on\":\"2007-09-28\"},{\"id\":71,\"name\":\"Full Metal Panic!\",\"russian\":\"Стальная тревога!\",\"image\":{\"original\":\"/system/animes/original/71.jpg?1674378748\",\"preview\":\"/system/animes/preview/71.jpg?1674378748\",\"x96\":\"/system/animes/x96/71.jpg?1674378748\",\"x48\":\"/system/animes/x48/71.jpg?1674378748\"},\"url\":\"/animes/71-full-metal-panic\",\"kind\":\"tv\",\"score\":\"7.61\",\"status\":\"released\",\"episodes\":24,\"episodes_aired\":0,\"aired_on\":\"2002-01-08\",\"released_on\":\"2002-06-18\"},{\"id\":72,\"name\":\"Full Metal Panic? Fumoffu\",\"russian\":\"Стальная тревога? Фумоффу\",\"image\":{\"original\":\"/system/animes/original/72.jpg?1674378752\",\"preview\":\"/system/animes/preview/72.jpg?1674378752\",\"x96\":\"/system/animes/x96/72.jpg?1674378752\",\"x48\":\"/system/animes/x48/72.jpg?1674378752\"},\"url\":\"/animes/72-full-metal-panic-fumoffu\",\"kind\":\"tv\",\"score\":\"8.03\",\"status\":\"released\",\"episodes\":12,\"episodes_aired\":0,\"aired_on\":\"2003-08-26\",\"released_on\":\"2003-11-18\"},{\"id\":73,\"name\":\"Full Metal Panic! The Second Raid\",\"russian\":\"Стальная тревога! Новый рейд\",\"image\":{\"original\":\"/system/animes/original/73.jpg?1674378754\",\"preview\":\"/system/animes/preview/73.jpg?1674378754\",\"x96\":\"/system/animes/x96/73.jpg?1674378754\",\"x48\":\"/system/animes/x48/73.jpg?1674378754\"},\"url\":\"/animes/73-full-metal-panic-the-second-raid\",\"kind\":\"tv\",\"score\":\"7.93\",\"status\":\"released\",\"episodes\":13,\"episodes_aired\":0,\"aired_on\":\"2005-07-14\",\"released_on\":\"2005-10-20\"},{\"id\":121,\"name\":\"Fullmetal Alchemist\",\"russian\":\"Стальной алхимик\",\"image\":{\"original\":\"/system/animes/original/121.jpg?1674379201\",\"preview\":\"/system/animes/preview/121.jpg?1674379201\",\"x96\":\"/system/animes/x96/121.jpg?1674379201\",\"x48\":\"/system/animes/x48/121.jpg?1674379201\"},\"url\":\"/animes/z121-fullmetal-alchemist\",\"kind\":\"tv\",\"score\":\"8.11\",\"status\":\"released\",\"episodes\":51,\"episodes_aired\":0,\"aired_on\":\"2003-10-04\",\"released_on\":\"2004-10-02\"},{\"id\":430,\"name\":\"Fullmetal Alchemist: The Conqueror of Shamballa\",\"russian\":\"Стальной алхимик: Завоеватель Шамбалы\",\"image\":{\"original\":\"/system/animes/original/430.jpg?1674335593\",\"preview\":\"/system/animes/preview/430.jpg?1674335593\",\"x96\":\"/system/animes/x96/430.jpg?1674335593\",\"x48\":\"/system/animes/x48/430.jpg?1674335593\"},\"url\":\"/animes/z430-fullmetal-alchemist-the-conqueror-of-shamballa\",\"kind\":\"movie\",\"score\":\"7.52\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"2005-07-23\",\"released_on\":null},{\"id\":554,\"name\":\"Koutetsu Tenshi Kurumi\",\"russian\":\"Стальной ангел Куруми\",\"image\":{\"original\":\"/system/animes/original/554.jpg?1674336337\",\"preview\":\"/system/animes/preview/554.jpg?1674336337\",\"x96\":\"/system/animes/x96/554.jpg?1674336337\",\"x48\":\"/system/animes/x48/554.jpg?1674336337\"},\"url\":\"/animes/554-koutetsu-tenshi-kurumi\",\"kind\":\"tv\",\"score\":\"6.76\",\"status\":\"released\",\"episodes\":24,\"episodes_aired\":0,\"aired_on\":\"1999-10-05\",\"released_on\":\"2000-04-04\"},{\"id\":555,\"name\":\"Koutetsu Tenshi Kurumi 2\",\"russian\":\"Стальной ангел Куруми 2\",\"image\":{\"original\":\"/system/animes/original/555.jpg?1674336340\",\"preview\":\"/system/animes/preview/555.jpg?1674336340\",\"x96\":\"/system/animes/x96/555.jpg?1674336340\",\"x48\":\"/system/animes/x48/555.jpg?1674336340\"},\"url\":\"/animes/555-koutetsu-tenshi-kurumi-2\",\"kind\":\"tv\",\"score\":\"6.27\",\"status\":\"released\",\"episodes\":12,\"episodes_aired\":0,\"aired_on\":\"2001-04-12\",\"released_on\":\"2001-06-28\"},{\"id\":556,\"name\":\"Koutetsu Tenshi Kurumi Zero\",\"russian\":\"Стальной ангел Куруми\",\"image\":{\"original\":\"/system/animes/original/556.jpg?1674336349\",\"preview\":\"/system/animes/preview/556.jpg?1674336349\",\"x96\":\"/system/animes/x96/556.jpg?1674336349\",\"x48\":\"/system/animes/x48/556.jpg?1674336349\"},\"url\":\"/animes/556-koutetsu-tenshi-kurumi-zero\",\"kind\":\"ova\",\"score\":\"6.06\",\"status\":\"released\",\"episodes\":3,\"episodes_aired\":0,\"aired_on\":\"2001-04-18\",\"released_on\":\"2001-06-20\"},{\"id\":557,\"name\":\"Koutetsu Tenshi Kurumi Encore\",\"russian\":\"Стальной ангел Куруми\",\"image\":{\"original\":\"/system/animes/original/557.jpg?1674336364\",\"preview\":\"/system/animes/preview/557.jpg?1674336364\",\"x96\":\"/system/animes/x96/557.jpg?1674336364\",\"x48\":\"/system/animes/x48/557.jpg?1674336364\"},\"url\":\"/animes/557-koutetsu-tenshi-kurumi-encore\",\"kind\":\"ova\",\"score\":\"6.66\",\"status\":\"released\",\"episodes\":4,\"episodes_aired\":0,\"aired_on\":\"2000-07-19\",\"released_on\":\"2000-10-04\"},{\"id\":664,\"name\":\"Fullmetal Alchemist: Reflections\",\"russian\":\"Стальной алхимик: Размышления\",\"image\":{\"original\":\"/system/animes/original/664.jpg?1674336926\",\"preview\":\"/system/animes/preview/664.jpg?1674336926\",\"x96\":\"/system/animes/x96/664.jpg?1674336926\",\"x48\":\"/system/animes/x48/664.jpg?1674336926\"},\"url\":\"/animes/z664-fullmetal-alchemist-reflections\",\"kind\":\"special\",\"score\":\"7.25\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"2005-03-19\",\"released_on\":null},{\"id\":908,\"name\":\"Fullmetal Alchemist: Premium Collection\",\"russian\":\"Стальной алхимик: Премиум коллекция\",\"image\":{\"original\":\"/system/animes/original/908.jpg?1674337861\",\"preview\":\"/system/animes/preview/908.jpg?1674337861\",\"x96\":\"/system/animes/x96/908.jpg?1674337861\",\"x48\":\"/system/animes/x48/908.jpg?1674337861\"},\"url\":\"/animes/z908-fullmetal-alchemist-premium-collection\",\"kind\":\"ova\",\"score\":\"7.3\",\"status\":\"released\",\"episodes\":3,\"episodes_aired\":0,\"aired_on\":\"2006-03-29\",\"released_on\":null},{\"id\":1015,\"name\":\"Full Metal Panic! The Second Raid: Wari to Hima na Sentaichou no Ichinichi\",\"russian\":\"Стальная тревога! Новый рейд: Выходной день капитана\",\"image\":{\"original\":\"/system/animes/original/1015.jpg?1674338271\",\"preview\":\"/system/animes/preview/1015.jpg?1674338271\",\"x96\":\"/system/animes/x96/1015.jpg?1674338271\",\"x48\":\"/system/animes/x48/1015.jpg?1674338271\"},\"url\":\"/animes/1015-full-metal-panic-the-second-raid-wari-to-hima-na-sentaichou-no-ichinichi\",\"kind\":\"special\",\"score\":\"7.66\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"2006-05-26\",\"released_on\":null},{\"id\":10842,\"name\":\"Fullmetal Alchemist: The Sacred Star of Milos Specials\",\"russian\":\"Стальной алхимик: Священная звезда Милоса — Спецвыпуски\",\"image\":{\"original\":\"/system/animes/original/10842.jpg?1674358044\",\"preview\":\"/system/animes/preview/10842.jpg?1674358044\",\"x96\":\"/system/animes/x96/10842.jpg?1674358044\",\"x48\":\"/system/animes/x48/10842.jpg?1674358044\"},\"url\":\"/animes/10842-fullmetal-alchemist-the-sacred-star-of-milos-specials\",\"kind\":\"ona\",\"score\":\"6.84\",\"status\":\"released\",\"episodes\":4,\"episodes_aired\":0,\"aired_on\":\"2011-06-10\",\"released_on\":\"2011-06-30\"},{\"id\":14543,\"name\":\"Koutetsu no Majo Annerose\",\"russian\":\"Стальная ведьма Аннероуз\",\"image\":{\"original\":\"/system/animes/original/14543.jpg?1675110307\",\"preview\":\"/system/animes/preview/14543.jpg?1675110307\",\"x96\":\"/system/animes/x96/14543.jpg?1675110307\",\"x48\":\"/system/animes/x48/14543.jpg?1675110307\"},\"url\":\"/animes/14543-koutetsu-no-majo-annerose\",\"kind\":\"ova\",\"score\":\"6.77\",\"status\":\"released\",\"episodes\":4,\"episodes_aired\":2,\"aired_on\":\"2012-07-27\",\"released_on\":\"2014-11-21\"},{\"id\":43,\"name\":\"Koukaku Kidoutai\",\"russian\":\"Призрак в доспехах\",\"image\":{\"original\":\"/system/animes/original/43.jpg?1674378515\",\"preview\":\"/system/animes/preview/43.jpg?1674378515\",\"x96\":\"/system/animes/x96/43.jpg?1674378515\",\"x48\":\"/system/animes/x48/43.jpg?1674378515\"},\"url\":\"/animes/43-koukaku-kidoutai\",\"kind\":\"movie\",\"score\":\"8.27\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"1995-11-18\",\"released_on\":null},{\"id\":17563,\"name\":\"Koutetsu no Vendetta Episode 0\",\"russian\":\"Стальная Вендетта\",\"image\":{\"original\":\"/system/animes/original/17563.jpg?1675111408\",\"preview\":\"/system/animes/preview/17563.jpg?1675111408\",\"x96\":\"/system/animes/x96/17563.jpg?1675111408\",\"x48\":\"/system/animes/x48/17563.jpg?1675111408\"},\"url\":\"/animes/17563-koutetsu-no-vendetta-episode-0\",\"kind\":\"ona\",\"score\":\"5.81\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"2013-02-22\",\"released_on\":null},{\"id\":7540,\"name\":\"Kurogane no Linebarrels Specials\",\"russian\":\"Стальные Лайнбаррели: Спецвыпуски\",\"image\":{\"original\":\"/system/animes/original/7540.jpg?1674353729\",\"preview\":\"/system/animes/preview/7540.jpg?1674353729\",\"x96\":\"/system/animes/x96/7540.jpg?1674353729\",\"x48\":\"/system/animes/x48/7540.jpg?1674353729\"},\"url\":\"/animes/7540-kurogane-no-linebarrels-specials\",\"kind\":\"special\",\"score\":\"6.52\",\"status\":\"released\",\"episodes\":2,\"episodes_aired\":0,\"aired_on\":\"2009-08-26\",\"released_on\":\"2009-11-14\"},{\"id\":7902,\"name\":\"Fullmetal Alchemist: Brotherhood - 4-Koma Theater\",\"russian\":\"Стальной алхимик: Братство — Четырёхпанельный театр\",\"image\":{\"original\":\"/system/animes/original/7902.jpg?1674354186\",\"preview\":\"/system/animes/preview/7902.jpg?1674354186\",\"x96\":\"/system/animes/x96/7902.jpg?1674354186\",\"x48\":\"/system/animes/x48/7902.jpg?1674354186\"},\"url\":\"/animes/z7902-fullmetal-alchemist-brotherhood-4-koma-theater\",\"kind\":\"special\",\"score\":\"7.46\",\"status\":\"released\",\"episodes\":16,\"episodes_aired\":0,\"aired_on\":\"2009-08-26\",\"released_on\":\"2010-11-24\"},{\"id\":8304,\"name\":\"Koutetsu Sangokushi Special\",\"russian\":\"Стальные хроники царств: Спецвыпуск\",\"image\":{\"original\":\"/system/animes/original/8304.jpg?1674354626\",\"preview\":\"/system/animes/preview/8304.jpg?1674354626\",\"x96\":\"/system/animes/x96/8304.jpg?1674354626\",\"x48\":\"/system/animes/x48/8304.jpg?1674354626\"},\"url\":\"/animes/8304-koutetsu-sangokushi-special\",\"kind\":\"special\",\"score\":\"6.3\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"2008-03-26\",\"released_on\":null},{\"id\":9135,\"name\":\"Fullmetal Alchemist: The Sacred Star of Milos\",\"russian\":\"Стальной алхимик: Священная звезда Милоса\",\"image\":{\"original\":\"/system/animes/original/9135.jpg?1674355753\",\"preview\":\"/system/animes/preview/9135.jpg?1674355753\",\"x96\":\"/system/animes/x96/9135.jpg?1674355753\",\"x48\":\"/system/animes/x48/9135.jpg?1674355753\"},\"url\":\"/animes/z9135-fullmetal-alchemist-the-sacred-star-of-milos\",\"kind\":\"movie\",\"score\":\"7.26\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"2011-07-02\",\"released_on\":null},{\"id\":6291,\"name\":\"Full Metal Panic! The Second Raid Episode 00\",\"russian\":\"Стальная тревога! Новый рейд: Эпизод 00\",\"image\":{\"original\":\"/system/animes/original/6291.jpg?1674351923\",\"preview\":\"/system/animes/preview/6291.jpg?1674351923\",\"x96\":\"/system/animes/x96/6291.jpg?1674351923\",\"x48\":\"/system/animes/x48/6291.jpg?1674351923\"},\"url\":\"/animes/z6291-full-metal-panic-the-second-raid-episode-00\",\"kind\":\"special\",\"score\":\"7.38\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"2005-07-06\",\"released_on\":null},{\"id\":6421,\"name\":\"Fullmetal Alchemist: Brotherhood Specials\",\"russian\":\"Стальной алхимик: Братство — Спецвыпуски\",\"image\":{\"original\":\"/system/animes/original/6421.jpg?1674352107\",\"preview\":\"/system/animes/preview/6421.jpg?1674352107\",\"x96\":\"/system/animes/x96/6421.jpg?1674352107\",\"x48\":\"/system/animes/x48/6421.jpg?1674352107\"},\"url\":\"/animes/z6421-fullmetal-alchemist-brotherhood-specials\",\"kind\":\"special\",\"score\":\"8.0\",\"status\":\"released\",\"episodes\":4,\"episodes_aired\":0,\"aired_on\":\"2009-08-26\",\"released_on\":\"2010-08-25\"},{\"id\":31931,\"name\":\"Full Metal Panic! Invisible Victory\",\"russian\":\"Стальная тревога! Незримая победа\",\"image\":{\"original\":\"/system/animes/original/31931.jpg?1675115177\",\"preview\":\"/system/animes/preview/31931.jpg?1675115177\",\"x96\":\"/system/animes/x96/31931.jpg?1675115177\",\"x48\":\"/system/animes/x48/31931.jpg?1675115177\"},\"url\":\"/animes/z31931-full-metal-panic-invisible-victory\",\"kind\":\"tv\",\"score\":\"7.58\",\"status\":\"released\",\"episodes\":12,\"episodes_aired\":12,\"aired_on\":\"2018-04-13\",\"released_on\":\"2018-07-18\"},{\"id\":33126,\"name\":\"Kurogane no Linebarrels Picture Drama\",\"russian\":\"Стальные Лайнбаррели: Истории в картинках\",\"image\":{\"original\":\"/system/animes/original/33126.jpg?1675115666\",\"preview\":\"/system/animes/preview/33126.jpg?1675115666\",\"x96\":\"/system/animes/x96/33126.jpg?1675115666\",\"x48\":\"/system/animes/x48/33126.jpg?1675115666\"},\"url\":\"/animes/33126-kurogane-no-linebarrels-picture-drama\",\"kind\":\"special\",\"score\":\"6.04\",\"status\":\"released\",\"episodes\":9,\"episodes_aired\":0,\"aired_on\":\"2009-12-14\",\"released_on\":\"2009-08-26\"},{\"id\":36342,\"name\":\"Full Metal Panic! Movie 1: Boy Meets Girl\",\"russian\":\"Стальная тревога: Парень встречает девушку\",\"image\":{\"original\":\"/system/animes/original/36342.jpg?1675117220\",\"preview\":\"/system/animes/preview/36342.jpg?1675117220\",\"x96\":\"/system/animes/x96/36342.jpg?1675117220\",\"x48\":\"/system/animes/x48/36342.jpg?1675117220\"},\"url\":\"/animes/36342-full-metal-panic-movie-1-boy-meets-girl\",\"kind\":\"movie\",\"score\":\"6.96\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":1,\"aired_on\":\"2017-11-25\",\"released_on\":null},{\"id\":36343,\"name\":\"Full Metal Panic! Movie 2: One Night Stand\",\"russian\":\"Стальная тревога: Одна ночь\",\"image\":{\"original\":\"/system/animes/original/36343.jpg?1675117220\",\"preview\":\"/system/animes/preview/36343.jpg?1675117220\",\"x96\":\"/system/animes/x96/36343.jpg?1675117220\",\"x48\":\"/system/animes/x48/36343.jpg?1675117220\"},\"url\":\"/animes/36343-full-metal-panic-movie-2-one-night-stand\",\"kind\":\"movie\",\"score\":\"6.97\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":1,\"aired_on\":\"2018-01-13\",\"released_on\":null},{\"id\":36344,\"name\":\"Full Metal Panic! Movie 3: Into the Blue\",\"russian\":\"Стальная тревога: В синеву\",\"image\":{\"original\":\"/system/animes/original/36344.jpg?1675117209\",\"preview\":\"/system/animes/preview/36344.jpg?1675117209\",\"x96\":\"/system/animes/x96/36344.jpg?1675117209\",\"x48\":\"/system/animes/x48/36344.jpg?1675117209\"},\"url\":\"/animes/36344-full-metal-panic-movie-3-into-the-blue\",\"kind\":\"movie\",\"score\":\"6.97\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":1,\"aired_on\":\"2018-01-20\",\"released_on\":null},{\"id\":34013,\"name\":\"Hagane Orchestra\",\"russian\":\"Стальной оркестр\",\"image\":{\"original\":\"/system/animes/original/34013.jpg?1675116065\",\"preview\":\"/system/animes/preview/34013.jpg?1675116065\",\"x96\":\"/system/animes/x96/34013.jpg?1675116065\",\"x48\":\"/system/animes/x48/34013.jpg?1675116065\"},\"url\":\"/animes/34013-hagane-orchestra\",\"kind\":\"tv\",\"score\":\"5.48\",\"status\":\"released\",\"episodes\":12,\"episodes_aired\":2,\"aired_on\":\"2016-10-10\",\"released_on\":\"2016-12-26\"},{\"id\":38149,\"name\":\"Full Metal Panic! Invisible Victory Intermission\",\"russian\":\"Стальная тревога! Незримая победа — Антракт\",\"image\":{\"original\":\"/system/animes/original/38149.jpg?1675118699\",\"preview\":\"/system/animes/preview/38149.jpg?1675118699\",\"x96\":\"/system/animes/x96/38149.jpg?1675118699\",\"x48\":\"/system/animes/x48/38149.jpg?1675118699\"},\"url\":\"/animes/38149-full-metal-panic-invisible-victory-intermission\",\"kind\":\"special\",\"score\":\"6.3\",\"status\":\"released\",\"episodes\":2,\"episodes_aired\":0,\"aired_on\":\"2018-05-11\",\"released_on\":\"2018-06-15\"},{\"id\":51830,\"name\":\"Steel Wonder\",\"russian\":\"Стальное чудо\",\"image\":{\"original\":\"/system/animes/original/51830.jpg?1685923916\",\"preview\":\"/system/animes/preview/51830.jpg?1685923916\",\"x96\":\"/system/animes/x96/51830.jpg?1685923916\",\"x48\":\"/system/animes/x48/51830.jpg?1685923916\"},\"url\":\"/animes/51830-steel-wonder\",\"kind\":\"music\",\"score\":\"0.0\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"2018-12-26\",\"released_on\":null},{\"id\":32245,\"name\":\"Kuromukuro\",\"russian\":\"Чёрная сталь\",\"image\":{\"original\":\"/system/animes/original/32245.jpg?1675115295\",\"preview\":\"/system/animes/preview/32245.jpg?1675115295\",\"x96\":\"/system/animes/x96/32245.jpg?1675115295\",\"x48\":\"/system/animes/x48/32245.jpg?1675115295\"},\"url\":\"/animes/32245-kuromukuro\",\"kind\":\"tv\",\"score\":\"7.14\",\"status\":\"released\",\"episodes\":26,\"episodes_aired\":26,\"aired_on\":\"2016-04-07\",\"released_on\":\"2016-09-29\"},{\"id\":1819,\"name\":\"Daimajuu Gekitou: Hagane no Oni\",\"russian\":\"Битва демонов: Стальной дьявол\",\"image\":{\"original\":\"/system/animes/original/1819.jpg?1674341319\",\"preview\":\"/system/animes/preview/1819.jpg?1674341319\",\"x96\":\"/system/animes/x96/1819.jpg?1674341319\",\"x48\":\"/system/animes/x48/1819.jpg?1674341319\"},\"url\":\"/animes/1819-daimajuu-gekitou-hagane-no-oni\",\"kind\":\"ova\",\"score\":\"5.22\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"1987-12-10\",\"released_on\":null},{\"id\":28623,\"name\":\"Koutetsujou no Kabaneri\",\"russian\":\"Кабанэри железной крепости\",\"image\":{\"original\":\"/system/animes/original/28623.jpg?1675113568\",\"preview\":\"/system/animes/preview/28623.jpg?1675113568\",\"x96\":\"/system/animes/x96/28623.jpg?1675113568\",\"x48\":\"/system/animes/x48/28623.jpg?1675113568\"},\"url\":\"/animes/28623-koutetsujou-no-kabaneri\",\"kind\":\"tv\",\"score\":\"7.27\",\"status\":\"released\",\"episodes\":12,\"episodes_aired\":12,\"aired_on\":\"2016-04-08\",\"released_on\":\"2016-07-01\"},{\"id\":23133,\"name\":\"M3: Sono Kuroki Hagane\",\"russian\":\"М3: Эта чёрная сталь\",\"image\":{\"original\":\"/system/animes/original/23133.jpg?1675112483\",\"preview\":\"/system/animes/preview/23133.jpg?1675112483\",\"x96\":\"/system/animes/x96/23133.jpg?1675112483\",\"x48\":\"/system/animes/x48/23133.jpg?1675112483\"},\"url\":\"/animes/23133-m3-sono-kuroki-hagane\",\"kind\":\"tv\",\"score\":\"6.57\",\"status\":\"released\",\"episodes\":24,\"episodes_aired\":24,\"aired_on\":\"2014-04-22\",\"released_on\":\"2014-09-30\"},{\"id\":25543,\"name\":\"M3: Sono Kuroki Hagane Recap\",\"russian\":\"М3: Эта чёрная сталь — Рекап\",\"image\":{\"original\":\"/system/animes/original/25543.jpg?1675113077\",\"preview\":\"/system/animes/preview/25543.jpg?1675113077\",\"x96\":\"/system/animes/x96/25543.jpg?1675113077\",\"x48\":\"/system/animes/x48/25543.jpg?1675113077\"},\"url\":\"/animes/25543-m3-sono-kuroki-hagane-recap\",\"kind\":\"ona\",\"score\":\"6.01\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"2014-07-22\",\"released_on\":null},{\"id\":31251,\"name\":\"Kidou Senshi Gundam: Tekketsu no Orphans\",\"russian\":\"Гандам: Железнокровные сироты\",\"image\":{\"original\":\"/system/animes/original/31251.jpg?1675114727\",\"preview\":\"/system/animes/preview/31251.jpg?1675114727\",\"x96\":\"/system/animes/x96/31251.jpg?1675114727\",\"x48\":\"/system/animes/x48/31251.jpg?1675114727\"},\"url\":\"/animes/z31251-kidou-senshi-gundam-tekketsu-no-orphans\",\"kind\":\"tv\",\"score\":\"8.05\",\"status\":\"released\",\"episodes\":25,\"episodes_aired\":25,\"aired_on\":\"2015-10-04\",\"released_on\":\"2016-03-27\"},{\"id\":3305,\"name\":\"Muteki Koujin Daitarn 3\",\"russian\":\"Непобедимый стальной человек Дайтарн 3\",\"image\":{\"original\":\"/system/animes/original/3305.jpg?1674346290\",\"preview\":\"/system/animes/preview/3305.jpg?1674346290\",\"x96\":\"/system/animes/x96/3305.jpg?1674346290\",\"x48\":\"/system/animes/x48/3305.jpg?1674346290\"},\"url\":\"/animes/3305-muteki-koujin-daitarn-3\",\"kind\":\"tv\",\"score\":\"7.16\",\"status\":\"released\",\"episodes\":40,\"episodes_aired\":0,\"aired_on\":\"1978-06-03\",\"released_on\":\"1979-03-31\"},{\"id\":33051,\"name\":\"Kidou Senshi Gundam: Tekketsu no Orphans 2nd Season\",\"russian\":\"Гандам: Железнокровные сироты 2\",\"image\":{\"original\":\"/system/animes/original/33051.jpg?1675115589\",\"preview\":\"/system/animes/preview/33051.jpg?1675115589\",\"x96\":\"/system/animes/x96/33051.jpg?1675115589\",\"x48\":\"/system/animes/x48/33051.jpg?1675115589\"},\"url\":\"/animes/z33051-kidou-senshi-gundam-tekketsu-no-orphans-2nd-season\",\"kind\":\"tv\",\"score\":\"8.23\",\"status\":\"released\",\"episodes\":25,\"episodes_aired\":25,\"aired_on\":\"2016-10-02\",\"released_on\":\"2017-04-02\"},{\"id\":33519,\"name\":\"Koutetsujou no Kabaneri Movie 1: Tsudou Hikari\",\"russian\":\"Кабанэри железной крепости 1: Собирая свет\",\"image\":{\"original\":\"/system/animes/original/33519.jpg?1675115794\",\"preview\":\"/system/animes/preview/33519.jpg?1675115794\",\"x96\":\"/system/animes/x96/33519.jpg?1675115794\",\"x48\":\"/system/animes/x48/33519.jpg?1675115794\"},\"url\":\"/animes/33519-koutetsujou-no-kabaneri-movie-1-tsudou-hikari\",\"kind\":\"movie\",\"score\":\"7.55\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"2016-12-31\",\"released_on\":null},{\"id\":33520,\"name\":\"Koutetsujou no Kabaneri Movie 2: Moeru Inochi\",\"russian\":\"Кабанэри железной крепости 2: Сгорающая жизнь\",\"image\":{\"original\":\"/system/animes/original/33520.jpg?1675115808\",\"preview\":\"/system/animes/preview/33520.jpg?1675115808\",\"x96\":\"/system/animes/x96/33520.jpg?1675115808\",\"x48\":\"/system/animes/x48/33520.jpg?1675115808\"},\"url\":\"/animes/33520-koutetsujou-no-kabaneri-movie-2-moeru-inochi\",\"kind\":\"movie\",\"score\":\"7.56\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":1,\"aired_on\":\"2017-01-07\",\"released_on\":null},{\"id\":7683,\"name\":\"Suiren no Hito\",\"russian\":\"Ностальгия\",\"image\":{\"original\":\"/system/animes/original/7683.jpg?1674353934\",\"preview\":\"/system/animes/preview/7683.jpg?1674353934\",\"x96\":\"/system/animes/x96/7683.jpg?1674353934\",\"x48\":\"/system/animes/x48/7683.jpg?1674353934\"},\"url\":\"/animes/7683-suiren-no-hito\",\"kind\":\"movie\",\"score\":\"5.49\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"2000-01-01\",\"released_on\":null},{\"id\":55140,\"name\":\"Nostalgia\",\"russian\":\"Ностальгия\",\"image\":{\"original\":\"/system/animes/original/55140.jpg?1682598263\",\"preview\":\"/system/animes/preview/55140.jpg?1682598263\",\"x96\":\"/system/animes/x96/55140.jpg?1682598263\",\"x48\":\"/system/animes/x48/55140.jpg?1682598263\"},\"url\":\"/animes/55140-nostalgia\",\"kind\":\"music\",\"score\":\"0.0\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"2017-05-26\",\"released_on\":null},{\"id\":2972,\"name\":\"Kindan no Mokushiroku: Crystal Triangle\",\"russian\":\"Хрустальный треугольник\",\"image\":{\"original\":\"/system/animes/original/2972.jpg?1674345478\",\"preview\":\"/system/animes/preview/2972.jpg?1674345478\",\"x96\":\"/system/animes/x96/2972.jpg?1674345478\",\"x48\":\"/system/animes/x48/2972.jpg?1674345478\"},\"url\":\"/animes/2972-kindan-no-mokushiroku-crystal-triangle\",\"kind\":\"ova\",\"score\":\"4.53\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"1987-07-22\",\"released_on\":null},{\"id\":36136,\"name\":\"Crystal Clear\",\"russian\":\"Кристально чистый\",\"image\":{\"original\":\"/system/animes/original/36136.jpg?1675117064\",\"preview\":\"/system/animes/preview/36136.jpg?1675117064\",\"x96\":\"/system/animes/x96/36136.jpg?1675117064\",\"x48\":\"/system/animes/x48/36136.jpg?1675117064\"},\"url\":\"/animes/36136-crystal-clear\",\"kind\":\"music\",\"score\":\"6.41\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"2017-07-19\",\"released_on\":null},{\"id\":39500,\"name\":\"Crystal Sea Ver. 69 (Kay Nakayama Remix)\",\"russian\":\"Кристальное море\",\"image\":{\"original\":\"/system/animes/original/39500.jpg?1675119627\",\"preview\":\"/system/animes/preview/39500.jpg?1675119627\",\"x96\":\"/system/animes/x96/39500.jpg?1675119627\",\"x48\":\"/system/animes/x48/39500.jpg?1675119627\"},\"url\":\"/animes/39500-crystal-sea-ver-69-kay-nakayama-remix\",\"kind\":\"music\",\"score\":\"5.52\",\"status\":\"released\",\"episodes\":1,\"episodes_aired\":0,\"aired_on\":\"2010-01-01\",\"released_on\":null}]";

            var result = await httpClient.GetStringAsync($"/api/animes?search={searchAnime}&limit=50");

            Assert.AreEqual(expectedResult, result);
            httpClient.Dispose();
        }
        /// <summary>
        /// Данный тест проверяет правильность
        /// вывода информации о произведениях
        /// из базы данных
        /// </summary>
        [TestMethod]
        public void GetMangaTest_MangaInList()
        {
            MangaListModel mangaListModel = new MangaListModel(_httpClientFactory, _httpContextAccessor);

            string Email = "xportbfgh2821@gmail.com";

            List<PieceInList> expected = new List<PieceInList>()
            {
                new PieceInList
                {
                    pieceId = 70345,
                    userEmail = Email,
                    userList = "Читаю"
                }
            };

            Task<IEnumerable<FirebaseObject<PieceInList>>> resultTask = mangaListModel.GetManga("Читаю", "xportbfgh2821@gmail.com");
            resultTask.Wait();
            IEnumerable<FirebaseObject<PieceInList>> result = resultTask.Result;

            List<PieceInList> realResult = new List<PieceInList>();
            foreach (var piece in result)
            {
                realResult.Add(piece.Object);
            }

            if (realResult.Count == expected.Count)
            {
                for (int i = 0; i < expected.Count; i++)
                {
                    Assert.AreEqual(expected[i].ToString(), realResult[i].ToString());
                }
            }
        }
        /// <summary>
        /// Данный тест проверяет правильность
        /// авторизации в систему
        /// </summary>
        [TestMethod]
        public void OnPostAuthorizationTest_FailedAuhorization()
        {
            IndexModel indexModel = new IndexModel(_httpContextAccessor);

            string Email = "user45@gmail.com";
            string Password = "123456sdfsvvs78";

            IActionResult expected = new PageResult();

            Task<IActionResult> resultTask = indexModel.OnPostAuthorization(Email, Password);
            resultTask.Wait();
            IActionResult result = resultTask.Result;

            Assert.AreEqual(expected.ToString(), result.ToString());
        }
    }
}